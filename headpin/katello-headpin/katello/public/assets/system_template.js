var sliding_tree=function(a,e){var l=$("#"+a),q=l.find(".sliding_container .sliding_list"),c=l.find(".tree_breadcrumb"),n=l.find(".sliders"),k,j;var g=function(w){var u=p.breadcrumb[w],t=q.children(".no_content"),v=q.children(".has_content");p.current_tab=w;p.fetching=0;o(w);if(p.direction){v.removeClass("will_have_content");t.addClass("will_have_content")}if(!p.direction){t=v}p.prerender_cb(w);s(w,t)},s=function(v,u){if(p.breadcrumb[v]===undefined){v=p.default_tab}var t=p.breadcrumb[v];if(t.client_render){p.render_cb(v,function(w){u.html(w);p.tab_change_cb(v);b(v)})}else{if(t.cache){u.html(t.content);p.tab_change_cb(v);b(v)}else{p.fetching=v;$.get(t.url,function(w){if(p.fetching==v){if(w.html){u.html(w.html)}else{u.html(w)}p.fetching=0;p.tab_change_cb(v)}});b(v);u.html("<img src='images/spinner.gif' >")}}},b=function(y){var u=p.breadcrumb[y],t=q.children(".no_content"),w=q.children(".has_content");if(u.scrollable){q.addClass("ajaxScroll");q.attr("data-scroll_url",u.url)}else{q.removeClass("ajaxScroll")}if(p.direction){var x=p.direction=="right"?"left":"right",v=$(".sliding_container").width();if(x==="left"){q.css({left:0});w.after(t);q.animate({left:-v},500,function(){w.html("");w.removeClass("has_content");w.addClass("no_content");t.addClass("has_content");t.removeClass("no_content")})}else{q.css({left:-v});w.before(t);q.animate({left:0},500,function(){w.html("");w.removeClass("has_content");w.addClass("no_content");t.addClass("has_content");t.removeClass("no_content")})}p.direction=undefined}},r=function(u){var t=u.find(".link_details");if(t.hasClass("slide_left")){p.direction="left"}else{p.direction="right"}m(t.attr("id"))},m=function(u){var t={};t[p.bbq_tag]=u;$.bbq.pushState(t)},o=function(x){if(p.breadcrumb[x]===undefined){x=p.default_tab}var u=p.breadcrumb[x].trail,t=u,w="<ul>";k=x;c.html("");if(p.base_icon){if(u.length>0){w+=d(u[0],undefined,p.base_icon)}else{w+=d(x,true,p.base_icon)}t=u.slice(1,u.length)}else{if(u.length===0){w+='<li class="one-line-ellipsis"><div id="'+x+'" class="currentCrumb fl">'+p.breadcrumb[x].name+"</div></li>"}}if(u.length>0){for(var v=0;v<t.length;v++){w+=d(t[v])}w+='<li class="one-line-ellipsis"><div id="'+x+'" class="currentCrumb fl">'+p.breadcrumb[x].name+"</div></li>"}c.append(w)},d=function(w,t,v){var u='<li class="slide_link">';if(v){if(t){u+='<div class="'+v+' fl">'+w+"</div>"}else{u+='<div class="'+v+'_inactive fl">'+w+"</div>"}}u+='<div class="fl crumb link_details slide_left" id= "'+w+'">';if(!v){u+=p.breadcrumb[w].name}if(t===undefined){u+="\u2002\u00BB\u2002"}return u+"</div></li>"},h=function(){var t=$.bbq.getState(p.bbq_tag)||p.default_tab;if(p.current_tab!=t){g(t);$(document).trigger("hashchange."+a,[t])}},f=function(){var w,v=0,t=$("#filter_form"),u=$("#filter_input");t.submit(function(){u.change();return false});$(".filter_button").toggle(function(){w=$(".breadcrumb_filter");v=w.height();w.animate({height:v+40},{duration:200,queue:false});u.css("margin-left","4px");t.css("opacity","0").show();t.animate({opacity:"1"},{duration:200,queue:false});u.animate({width:(w.width()-60)+"px",opacity:"1"},{duration:200,queue:false});$(this).css({backgroundPosition:"-32px -16px"});$(this).attr("title",i18n.close);if($(".remove_item").length){$(".remove_item").css({top:52})}if($(".close").length){$(".close").css({top:52})}},function(){t.fadeOut("fast",function(){w.animate({height:v},"fast");if($(".remove_item").length){$(".remove_item").css({top:12})}if($(".close").length){$(".close").css({top:12})}});$(this).css({backgroundPosition:"0 -16px"});$(this).attr("title",i18n.filter);u.val("").change();$("#"+a+" .has_content .filterable li").fadeIn("fast")}).tipsy({fade:true,gravity:"s"});u.live("change, keyup",function(){if($.trim($(this).val()).length>=2){$("#"+a+" .has_content .filterable li:not(:contains('"+$(this).val()+"'))").filter(":not").fadeOut("fast");$("#"+a+" .has_content .filterable li:contains('"+$(this).val()+"')").filter(":hidden").fadeIn("fast")}else{$("#"+a+" .has_content .filterable li").fadeIn("fast")}});u.val("").change()},i=function(){j=sliding_tree.search();j.init(this,q)};var p={breadcrumb:{},bbq_tag:a,default_tab:"",current_tab:undefined,direction:undefined,base_icon:false,tab_change_cb:function(){},prerender_cb:function(){},render_cb:function(){},fetching:0};if(e){$.extend(p,e)}if(p.enable_filter){f()}if(p.enable_float){l.css("position","absolute");n.css("height",n.css("minHeight"))}$(window).unbind("hashchange."+a).bind("hashchange."+a,h);$(window).trigger("hashchange."+a);l.find(".slide_link").live("click",function(t){if(t.target.nodeName==="A"){return false}else{r($(this))}});return{get_current_crumb:function(){return k},get_breadcrumbs:function(){return p.breadcrumb},get_tree_id:function(){return a},render_content:m,rerender_content:function(){s($.bbq.getState(p.bbq_tag),q.children(".has_content"))},rerender_breadcrumb:function(){o($.bbq.getState(p.bbq_tag))},enableSearch:i}};sliding_tree.search=function(){var h,g=0,e,c,i,b,k=function(n,l){var m=n.get_tree_id();e=$("#search_form");c=$("#search_input");h=$(".breadcrumb_search");i=h.find(".search_button");g=h.height();b=n.get_breadcrumbs();i.toggle(function(){if(!i.hasClass("disabled")){f()}},function(){if(!i.hasClass("disabled")){j()}}).tipsy({fade:true,gravity:"s"});e.live("submit",function(q){var t=n.get_current_crumb(),p=b[t]["url"],s=s||0,r={},o=l.children(".has_content");q.preventDefault();if(b[t]["searchable"]){if($(this).serialize()!=="search="){$.bbq.pushState($(this).serialize())}p+="?offset="+s;o.html("<img src='images/spinner.gif' >");$(this).ajaxSubmit({url:p,data:r,cache:false,success:function(v){var u=v.html?v.html:v;o.html(u);$(document).trigger("search_complete.slidingtree")},error:function(u){}})}});$(document).bind("hashchange."+m,function(o,p){a(p)});a(n.get_current_crumb())},a=function(m){var l=b[m]["searchable"];$.bbq.removeState("search");d(l)},d=function(l){j();if(!l){i.css({backgroundPosition:"0 0"});i.addClass("disabled");i.attr("title",i18n.disabled_search)}else{i.css({backgroundPosition:"0 -16px"});i.removeClass("disabled");i.attr("title",i18n.search)}},f=function(){h.animate({height:g+40},{duration:200,queue:false});c.css("margin-left","4px");e.css("opacity","0").show();e.animate({opacity:"1"},{duration:200,queue:false});c.animate({width:(h.width()-60)+"px",opacity:"1"},{duration:200,queue:false});i.css({backgroundPosition:"-32px -16px"});i.attr("title",i18n.close)},j=function(){e.fadeOut("fast",function(){h.animate({height:g},"fast")});i.css({backgroundPosition:"0 -16px"});i.attr("title",i18n.search)};return{init:k,open:f,close:j}};sliding_tree.ActionBar=function(e){var f=undefined,e=e||{},a=function(j,i){var i=i||{};i.animate_time=500;if(f!==j&&f!==undefined){i.opening=false;e[f].setup_fn(i);$("#"+e[f].container).slideToggle(i.animate_time,function(){f=j;i.opening=true;h(i,j)})}else{if(f!==undefined){f=undefined;i.opening=false;h(i,j)}else{f=j;i.opening=true;h(i,j)}}},h=function(i,k){var j=$("#"+e[k].container);i=e[k].setup_fn(i);j.slideToggle(i.animate_time,i.after_function)},g=function(){if(f){a(f,{opening:false})}},d=function(){g()},b=function(j,i){if(e[j]!==undefined){delete e[j]}e[j]=i;c(j,i)},c=function(j,i){$("#"+i.button).unbind("click").click(function(){if($(this).hasClass("disabled")){return false}a(j,i.options)});$("#"+i.button).unbind("keypress").keypress(function(k){k.preventDefault();if($(this).hasClass("disabled")){return false}if(k.which===13){a(j,i.options)}})};for(item in e){c(item,e[item])}return{toggle:a,close:g,reset:d,add_to_toggle_list:b}};KT.auto_complete_box=function(d){var c={values:undefined,default_text:undefined,input_id:undefined,form_id:undefined,add_btn_id:undefined,add_text:i18n.add_plus,add_cb:function(l,k){k()}};$.extend(c,d);var g=function(m){var l=$("#"+c.input_id).attr("value");var k=$("#"+c.add_btn_id);m.preventDefault();if(l.length===0||l===c.default_text||l.length===0){return}k.addClass("working");a(l,true)},a=function(n,l){var m=$("#"+c.input_id);var k=$("#"+c.add_btn_id);k.addClass("working");k.html("<img  src='images/spinner.gif'>");m.attr("disabled","disabled");m.autocomplete("disable");m.autocomplete("close");c.add_cb(n,function(){e();if(l){$("#"+c.input_id).focus()}})},e=function(){var l=$("#"+c.input_id);var k=$("#"+c.add_btn_id);k.removeClass("working");if(k.text()===""){k.html(c.add_text)}l.val("");l.removeAttr("disabled");l.autocomplete("enable")},i=function(k){a(k,false)},f=function(){var k=$("#"+c.input_id);k.addClass("error")};var h=$("#"+c.input_id);var b=$("#"+c.form_id);var j=$("#"+c.add_btn_id);if(c.default_text){h.val(c.default_text);h.focus(function(){if(h.val()===c.default_text){h.val("")}});h.blur(function(){if(h.val()===""){h.val(c.default_text)}})}h.autocomplete({source:c.values});j.click(g);b.submit(g);return{manually_add:i,error:f}};KT.options={action_bar:undefined,template_tree:undefined,content_tree:undefined,current_template:undefined,templates:undefined};KT.templates=function(){var t={edit:undefined,remove:undefined,save:undefined,download:undefined,discard_dialog:undefined,save_dialog:undefined},h=function(B,C){$("#tree_loading").css("z-index",300);$.ajax({type:"GET",url:KT.common.rootURL()+"/system_templates/"+B+"/object/",cache:false,success:function(D){$("#tree_loading").css("z-index",-1);KT.options.current_template=D;C()}})},v=function(B){var C=KT.options.current_template.id;KT.options.current_template.name=B;KT.template_breadcrumb["details_"+C].name=B;$.each(KT.options.templates,function(D,E){if(E.template_id===C){E.template_name=B;return true}})},c=function(B){KT.options.current_template.description=B},i=function(B){delete KT.template_breadcrumb["details_"+B];$.each(KT.options.templates,function(C,D){if(D&&D.template_id===B){KT.options.templates.splice(C,1);return true}});KT.options.template_tree.render_content("templates")},f=function(D,B){var C={template_name:B,template_id:D};KT.options.templates.push(C);o(D,B);KT.options.template_tree.render_content("details_"+D)},o=function(E,B){var D=KT.template_breadcrumb;var C="details_"+E;D[C]={cache:null,client_render:true,name:B,trail:["templates"],url:"url"};D["packages_"+E]={cache:null,client_render:true,name:i18n.packages,trail:["templates",C],url:""};D["repos_"+E]={cache:null,client_render:true,name:i18n.repos,trail:["templates",C],url:""};D["distribution_"+E]={cache:null,client_render:true,name:i18n.selected_distribution,trail:["templates",C],url:""};D["products_"+E]={cache:null,client_render:true,name:i18n.products,trail:["templates",C],url:""};D["comps_"+E]={cache:null,client_render:true,name:i18n.package_groups,trail:["templates",C],url:""}},u=function(B,D){var C=-1;$.each(D,function(E,F){if(F.name===B){C=E;return false}});return C},e=function(B){return u(B,KT.options.current_template.packages)>-1},w=function(B){var C=KT.options.current_template.packages;if(!e(B)){C.push({name:B})}KT.options.current_template.modified=true;KT.options.template_tree.rerender_content()},x=function(B,D){var C=u(B,D);if(C>-1){D.splice(C,1);KT.options.current_template.modified=true;j(B,false);KT.options.template_tree.rerender_content()}},q=function(B){x(B,KT.options.current_template.packages)},d=function(B){return u(B,KT.options.current_template.package_groups)>-1},r=function(C){var B=KT.options.current_template.package_groups;if(!d(C)){B.push({name:C})}KT.options.current_template.modified=true;KT.options.template_tree.rerender_content()},l=function(B){x(B,KT.options.current_template.package_groups)},k=function(B){return u(B,KT.options.current_template.repos)>-1},y=function(B){var C=KT.options.current_template.repos;if(!k(B)){C.push({name:B})}KT.options.current_template.modified=true;KT.options.template_tree.rerender_content()},A=function(B){x(B,KT.options.current_template.repos)},g=function(){if(KT.options.current_template===undefined||!KT.permissions.editable){t.edit.addClass("disabled");t.remove.addClass("disabled");t.save.addClass("disabled");t.download.addClass("disabled");$(".package_add_remove").hide();$(".package_group_add_remove").hide();$(".repo_add_remove").hide();$(".product_add_remove").hide()}else{t.edit.removeClass("disabled");t.remove.removeClass("disabled");t.download.removeClass("disabled");if(KT.options.current_template.modified){t.save.removeClass("disabled")}else{t.save.addClass("disabled")}$.each([["package",KT.options.current_template.packages],["package_group",KT.options.current_template.package_groups],["repo",KT.options.current_template.repos]],function(B,D){var C=D[0];var E=D[1];$("."+C+"_add_remove").not(".working").show().text(i18n.add_plus);$.each(E,function(F,H){var G=$('a[data-name="'+H.name+'"].'+C+"_add_remove").not(".working");if(G.length>0){G.text(i18n.remove)}})});$(".product_add_remove").not(".working").show().text(i18n.add_plus);$.each(KT.options.current_template.products,function(B,D){var C=$("a[data-id="+D.id+"].product_add_remove").not(".working");if(C.length>0){C.text(i18n.remove)}})}m()},n=function(){$("#error_dialog").dialog({closeOnEscape:false,modal:true,open:function(B,C){$(".ui-dialog-titlebar-close").hide()}})},m=function(){$(".right_tree .will_have_content").find("li").sortElements(function(C,B){var E=$(C).find(".sort_attr").html();var D=$(B).find(".sort_attr").html();if(E&&D){return E.toUpperCase()>D.toUpperCase()?1:-1}})},j=function(D,B){var C=$("a[data-name='"+D+"']");if(C.length>0){if(B){C.text(i18n.remove)}else{C.text(i18n.add_plus)}}},z=function(C){var B=-1;$.each(KT.options.current_template.products,function(D,E){if(E.id+""===C+""){B=D;return false}});return B},s=function(B,C){if(!b(B,C)){KT.options.current_template.products.push({name:B,id:C});KT.options.current_template.modified=true;KT.options.template_tree.rerender_content()}},b=function(B,C){return z(C)>-1},a=function(B,E){var C=KT.options.current_template.products;var D=z(E);if(D>-1){C.splice(D,1);KT.options.current_template.modified=true;KT.options.template_tree.rerender_content()}},p=function(B){KT.options.current_template.distribution=B;KT.options.current_template.modified=true;KT.templates.reset_page()};return{fetch_template:h,add_new_template:f,remove_template:i,set_current_name:v,set_current_description:c,reset_page:g,buttons:t,throw_error:n,sort_content:m,add_package:w,remove_package:q,has_package:e,add_repo:y,remove_repo:A,has_repo:k,add_product:s,remove_product:a,has_product:b,has_package_group:d,add_package_group:r,remove_package_group:l,set_distro:p}}();KT.template_renderer=function(){var b=function(q,o){var p=KT.options.current_template;if(q===undefined){KT.options.current_template=undefined;o()}else{if(p===undefined||p.id!=q){KT.templates.fetch_template(q,function(){o()})}else{o()}}},f=function(u,r){var t=u.split("_")[0];var q=u.split("_")[1];var p=KT.options.current_template;var s=false;if(p&&(u==="templates"||q+""!==p.id+"")){s=p.modified}var o=function(){b(q,function(){var v="";if(u==="templates"){v=k()}else{if(t==="details"){v=a(q)}else{if(t==="packages"){v=h()}else{if(t=="repos"){v=g()}else{if(t==="products"){v=l()}else{if(t==="comps"){v=c()}else{if(t==="distribution"){v=e()}}}}}}}r(v)})};if(s){KT.actions.open_modified_dialog(function(){KT.templates.buttons.save.click()},o)}else{o()}},i=function(r,q,o){var p='<li class="'+(o?"slide_link":"")+'">';p+='<div class="link_details simple_link one-line-ellipsis" id="'+r+'">';p+='<span class="sort_attr">'+q+"</span>";p+="</div></li>";return p},n=function(p){var o='<li class="">';o+='<div class="simple_link" id=pkg_"'+p+'">';o+='<span class="sort_attr">'+p+"</span>";if(KT.permissions.editable){o+='<a id="" class="fr st_button remove_package">'+i18n.remove+"</a>"}o+="</div></li>";return o},h=function(){var o="";if(KT.permissions.editable){o+='<ul ><li class="content_input_item"><form id="add_package_form">';o+='<input id="add_package_input" type="text" size="33"><form>  ';o+='<a id="add_package" class="fr st_button ">'+i18n.add_plus+"</a>";o+=" </li></ul>"}o+='<ul class="filterable">';$.each(KT.options.current_template.packages,function(p,q){o+=n(q.name)});return o+"</ul>"},j=function(o,q){var p='<li class="">';p+='<div class="simple_link" id=repo_"'+q+'">';p+='<span class="sort_attr">'+o+"</span>";if(KT.permissions.editable){p+='<a id="" class="fr st_button remove_repo" data-id="'+q+'" data-name="'+o+'">';p+=i18n.remove+"</a>"}p+="</div></li>";return p},g=function(){var o="";if(KT.permissions.editable){o+='<ul><li class="content_input_item"><form id="add_repo_form">';o+='<input id="add_repo_input" type="text" size="33"><form>  ';o+='<a id="add_repo" class="fr st_button ">'+i18n.add_plus+"</a>";o+=" </li></ul>"}o+='<ul class="filterable">';$.each(KT.options.current_template.repos,function(p,q){o+=j(q.name,q.id)});return o+"</ul>"},d=function(o,q){var p='<li class="">';p+='<div class="simple_link" id=prod_"'+q+'">';p+='<span class="sort_attr">'+o+"</span>";if(KT.permissions.editable){p+='<a id="" class="fr st_button remove_product" data-id="'+q+'" data-name="'+o+'">';p+=i18n.remove+"</a>"}p+="</div></li>";return p},l=function(){var o="";if(KT.permissions.editable){o+='<ul><li class="content_input_item"><form id="add_product_form">';o+='<input id="add_product_input" type="text" size="33"><form>  ';o+='<a id="add_product" class="fr st_button ">'+i18n.add_plus+"</a>";o+=" </li></ul>"}o+='<ul class="filterable">';$.each(KT.options.current_template.products,function(p,q){o+=d(q.name,q.id)});return o+"</ul>"},c=function(){var o="";if(KT.permissions.editable){o+='<ul ><li class="content_input_item"><form id="add_package_group_form">';o+='<input id="add_package_group_input" type="text" size="33"><form>  ';o+='<a id="add_package_group" class="fr st_button ">'+i18n.add_plus+"</a>";o+=" </li></ul>"}o+='<ul class="filterable">';$.each(KT.options.current_template.package_groups,function(p,q){o+=m(q.name)});return o+"</ul>"},m=function(p){var o='<li class="">';o+='<div class="simple_link" id=group_"'+p+'">';o+='<span class="sort_attr">'+p+"</span>";if(KT.permissions.editable){o+='<a id="" class="fr st_button remove_package_group">'+i18n.remove+"</a>"}o+="</div></li>";return o},e=function(o){var p="",r=[],s=KT.options.current_template,q;if(s.products.length===0&&s.repos.length===0){return i18n.need_product_or_repo}$.each(s.products,function(u,t){$.each(KT.product_distributions[t.id],function(v,w){if(r.indexOf(w.id)===-1){r.push(w.id)}})});$.each(s.repos,function(t,u){$.each(KT.repo_distributions[u.name],function(v,w){if(r.indexOf(w.id)===-1){r.push(w.id)}})});if(r.length==0){return i18n.need_distro_product_or_repo}p="<ul>";$.each(r,function(t,u){q=(u===s.distribution)?" checked ":"";p+='<li class="no_hover">';p+="<input "+q+'type="radio" class="distro_select" name="distro" value="'+u+'" id="'+u+'"> ';p+='<span class="sort_attr"><label for="'+u+'">'+u+"</label></span>";p+="</li>"});p+="</ul>";return p},a=function(p){var o="<ul>";$.each([["products_",i18n.products],["repos_",i18n.repos],["packages_",i18n.packages],["comps_",i18n.package_groups],["distribution_",i18n.selected_distribution]],function(q,r){o+=i(r[0]+p,r[1],true)});return o+"</ul>"},k=function(){var p=KT.options.templates;if(p.length===0){return i18n.templates_empty}var o='<ul class="filterable">';$.each(p,function(q,r){o+=i("details_"+r.template_id,r.template_name,true)});o+="</ul>";return o};return{render_hash:f}}();KT.auto_complete_box=function(d){var c={values:undefined,default_text:undefined,input_id:undefined,form_id:undefined,add_btn_id:undefined,add_text:i18n.add_plus,add_cb:function(l,k){k()}};$.extend(c,d);var g=function(m){var l=$("#"+c.input_id).attr("value");var k=$("#"+c.add_btn_id);m.preventDefault();if(l.length===0||l===c.default_text){return}k.addClass("working");a(l,true)},a=function(n,l){var m=$("#"+c.input_id);var k=$("#"+c.add_btn_id);k.addClass("working");k.html("<img  src='images/spinner.gif'>");m.attr("disabled","disabled");m.autocomplete("disable");m.autocomplete("close");c.add_cb(n,function(){e();if(l){$("#"+c.input_id).focus()}})},e=function(){var l=$("#"+c.input_id);var k=$("#"+c.add_btn_id);k.removeClass("working");if(k.text()===""){k.html(c.add_text)}l.removeAttr("disabled");l.autocomplete("enable")},i=function(k){a(k,false)},f=function(){var k=$("#"+c.input_id);k.addClass("error")};var h=$("#"+c.input_id);var b=$("#"+c.form_id);var j=$("#"+c.add_btn_id);if(c.default_text){h.val(c.default_text);h.focus(function(){if(h.val()===c.default_text){h.val("")}});h.blur(function(){if(h.val()===""){h.val(c.default_text)}})}h.autocomplete({source:c.values});j.bind("click",g);b.submit(g);return{manually_add:i,error:f}};KT.product_actions=(function(){var d=undefined,c=function(){d=KT.auto_complete_box({values:Object.keys(KT.product_hash),default_text:i18n.product_search_text,input_id:"add_product_input",form_id:"add_product_form",add_btn_id:"add_product",add_cb:a})},a=function(f,e){var g=Object.keys(KT.product_hash);if($.inArray(f,g)>-1){KT.templates.add_product(f,KT.product_hash[f])}else{d.error()}e()},b=function(){$(".remove_product").live("click",function(){var f=$(this);var g=f.attr("data-id");var e=f.attr("data-name");if(e&&g){KT.templates.remove_product(e,g)}});$(".product_add_remove").live("click",function(){var f=$(this);var e=f.attr("data-name");var g=f.attr("data-id");if(KT.templates.has_product(e,g)){KT.templates.remove_product(e,g)}else{f.html("<img  src='images/spinner.gif'>");d.manually_add(e,KT.product_hash[e])}})};return{register_autocomplete:c,register_events:b}})();KT.repo_actions=(function(){var d=undefined,c=function(){d=KT.auto_complete_box({values:KT.routes.auto_complete_library_repositories_path(),default_text:i18n.repo_search_text,input_id:"add_repo_input",form_id:"add_repo_form",add_btn_id:"add_repo",add_cb:b})},b=function(f,e){$.ajax({type:"GET",url:KT.routes.auto_complete_library_repositories_path(),data:{term:f},cache:false,success:function(g){if($.inArray(f,g)>-1){KT.templates.add_repo(f)}else{d.error()}e()},error:KT.templates.throw_error})},a=function(){$(".remove_repo").live("click",function(){var e=$(this).siblings("span").text();if(e&&e.length>0){KT.templates.remove_repo(e)}});$(".repo_add_remove").live("click",function(){var f=$(this);var e=f.attr("data-name");if(KT.templates.has_repo(e)){KT.templates.remove_repo(e)}else{f.html("<img  src='images/spinner.gif'>");d.manually_add(e)}})};return{register_events:a,register_autocomplete:c}})();KT.package_actions=(function(){var e=undefined,d=function(){e=KT.auto_complete_box({values:KT.routes.auto_complete_library_packages_path(),default_text:i18n.package_search_text,input_id:"add_package_input",form_id:"add_package_form",add_btn_id:"add_package",add_cb:b})},b=function(g,f){$.ajax({type:"GET",url:KT.routes.auto_complete_library_packages_path(),data:{term:g},cache:false,success:function(h){if($.inArray(g,h)>-1){KT.templates.add_package(g)}else{e.error()}f()},error:KT.templates.throw_error})},a=function(g,f){$.ajax({type:"GET",url:auto_complete_package,data:{term:g.term},cache:false,success:function(h){f(h.splice(0,20))},error:KT.templates.throw_error})},c=function(){$(".remove_package").live("click",function(){var f=$(this).siblings("span").text();if(f&&f.length>0){KT.templates.remove_package(f)}});$(".package_add_remove").live("click",function(){var g=$(this);var f=g.attr("data-name");if(KT.templates.has_package(f)){KT.templates.remove_package(f)}else{g.html("<img  src='images/spinner.gif'>");e.manually_add(f)}})};return{register_events:c,register_autocomplete:d}})();KT.package_group_actions=(function(){var d=undefined;var c=function(){d=KT.auto_complete_box({values:KT.package_groups,default_text:i18n.package_group_search_text,input_id:"add_package_group_input",form_id:"add_package_group_form",add_btn_id:"add_package_group",add_cb:e})},e=function(g,f){if($.inArray(g,KT.package_groups)>-1){KT.templates.add_package_group(g)}else{d.error()}f()},a=function(g,f){$.ajax({type:"GET",url:KT.common.rootURL()+"/system_templates/auto_complete_package_groups",data:{name:g.term},cache:false,success:function(h){f(h.splice(0,20))},error:KT.templates.throw_error})},b=function(){$(".remove_package_group").live("click",function(){var f=$(this).siblings("span").text();if(f&&f.length>0){KT.templates.remove_package_group(f)}});$(".package_group_add_remove").live("click",function(){var g=$(this);var f=g.attr("data-name");if(KT.templates.has_package_group(f)){KT.templates.remove_package_group(f)}else{g.html("<img  src='images/spinner.gif'>");d.manually_add(f)}})};return{register_events:b,register_autocomplete:c}})();KT.actions=(function(){var j=KT.options;var f=KT.templates.buttons;var d=function(k){var m=i18n.edit_close_label;if(k.opening){var l=KT.options.current_template;$("#edit_template_name").text(l.name);$("#edit_template_description").text(l.description);KT.editable.setup_editable_name(l.id,function(n){KT.templates.set_current_name(n);KT.options.template_tree.rerender_breadcrumb()});KT.editable.setup_editable_description(l.id,function(n){KT.templates.set_current_description(n)})}else{m=i18n.edit_label}h();f.edit.find(".text").text(m);return{}},e=function(m){var o=i18n.edit_close_label;if(m.opening){var n=KT.options.current_template;var k="";envs=n.environments;if(envs.length==0){k+='<option value="">i18n.noEnvironments</option>'}else{for(var l=0;l<envs.length;l++){k+='<option value="'+envs[l].id+'">'+envs[l].name+"</option>"}}$("#system_template_environment_id").html(k)}return{}},i=function(){$("#modified_dialog").dialog("close");f.save_dialog.unbind("click");f.save_dialog.unbind("click")},g=function(k,l){var m=i18n.modify_message;m=m.replace("$TEMPLATE",j.current_template.name);$("#modified_dialog").dialog("open");$("#modified_dialog").find(".text").text(m);f.save_dialog.click(function(){i();k();l()});f.discard_dialog.click(function(){i();l()})},h=function(){f.edit.find(".text").text(i18n.edit_label)},a={template_edit:{container:"edit_template_container",button:"edit_template",setup_fn:d},template_download:{container:"download_template_container",button:"download_template",setup_fn:e}},c=function(){$("#panel").delegate("form[id^=new_system_template]","submit",function(m){var k=$("#template_save");var l=$("#add_template");m.preventDefault();k.attr("disabled","disabled");l.addClass("disabled");$(this).ajaxSubmit({success:function(n){k.removeAttr("disabled");l.removeClass("disabled");KT.panel.closePanel($("#panel"));KT.templates.add_new_template(n.id,n.name)},error:function(){k.removeAttr("disabled");l.removeClass("disabled")}})});f.remove.click(function(){if($(this).hasClass("disabled")||!KT.options.current_template){return false}KT.common.customConfirm($(this).attr("data-confirm-text"),function(){$.ajax({type:"DELETE",url:KT.routes.system_template_path(j.current_template.id),cache:false,success:function(k){KT.templates.remove_template(j.current_template.id)},error:KT.templates.throw_error})});return false});$("#download_key").live("click",function(k){k.preventDefault();environment_id=$("#system_template_environment_id").attr("value");url=KT.common.rootURL()+"/system_templates/"+j.current_template.id+"/download?environment_id="+environment_id;window.location.href=url;return false});$("#save_template").live("click",function(){if($(this).hasClass("disabled")){return false}$("#save_template").addClass("disabled");$("#tree_saving").css("z-index",300);var l=KT.options.current_template;var k={packages:l.packages,repos:l.repos,products:l.products,package_groups:l.package_groups,distribution:l.distribution};$.ajax({type:"PUT",contentType:"application/json",url:KT.routes.update_content_system_template_path(j.current_template.id),data:JSON.stringify(k),cache:false,success:function(m){$("#tree_saving").css("z-index",-1);KT.options.current_template=m},error:KT.templates.throw_error});return false})},b=function(){$(".distro_select").change(function(){KT.templates.set_distro($(this).attr("id"))})};return{toggle_list:a,register_events:c,open_modified_dialog:g,register_distro_select:b}})();KT.template_download={setup_environment_names:function(d,c){alert("in setup");var a="";a+='<option value="">'+i18n.noTemplate+"</option>";for(var b=0;b<response.length;b++){a+='<option value="'+response[b].id+'">'+response[b].name+"</option>"}$("#activation_key_system_template_id").html(a)}};KT.editable={setup_editable_name:function(b,a){$(".edit_template_name").each(function(){$(this).editable(KT.common.rootURL()+"/system_templates/"+b,{type:"text",width:250,method:"PUT",name:$(this).attr("name"),cancel:i18n.cancel,submit:i18n.save,indicator:i18n.saving,tooltip:i18n.clickToEdit,placeholder:i18n.clickToEdit,submitdata:{authenticity_token:AUTH_TOKEN},onsuccess:a,onerror:function(d,c,e){c.reset()}})})},setup_editable_description:function(b,a){$(".edit_template_description").each(function(){$(this).editable(KT.common.rootURL()+"/system_templates/"+b,{type:"textarea",rows:6,cols:30,method:"PUT",name:$(this).attr("name"),cancel:i18n.cancel,submit:i18n.save,indicator:i18n.saving,tooltip:i18n.clickToEdit,placeholder:i18n.clickToEdit,submitdata:{authenticity_token:AUTH_TOKEN},onsuccess:a,onerror:function(d,c,e){c.reset()}})})}};$(document).ready(function(){var a=KT.templates.buttons;a.edit=$("#edit_template");a.remove=$("#remove_template");a.download=$("#download_template");a.save=$("#save_template");a.save_dialog=$("#save_dialog");a.discard_dialog=$("#discard_dialog");$("#modified_dialog").dialog({modal:true,width:400,autoOpen:false});KT.panel.list.set_extended_cb(KT.templates.reset_page);KT.options.templates=KT.template_breadcrumb.templates.templates;KT.options.content_tree=sliding_tree("content_tree",{breadcrumb:KT.content_breadcrumb,default_tab:"products",bbq_tag:"products",base_icon:"home_img",enable_filter:false,tab_change_cb:function(b){KT.templates.reset_page()}});KT.options.template_tree=sliding_tree("template_tree",{breadcrumb:KT.template_breadcrumb,default_tab:"templates",bbq_tag:"template",base_icon:"home_img",render_cb:KT.template_renderer.render_hash,tab_change_cb:function(b){KT.package_actions.register_autocomplete();KT.repo_actions.register_autocomplete();KT.product_actions.register_autocomplete();KT.package_group_actions.register_autocomplete();KT.templates.reset_page();KT.actions.register_distro_select()},enable_filter:true,enable_float:true});KT.options.action_bar=sliding_tree.ActionBar(KT.actions.toggle_list);KT.actions.register_events();KT.package_actions.register_events();KT.repo_actions.register_events();KT.product_actions.register_events();KT.package_group_actions.register_events();KT.panel.registerPanel($("#template_tree"),$("#template_tree").width()+50);window.onbeforeunload=function(){if(KT.options.current_template&&KT.options.current_template.modified){return i18n.leave_page.replace("$TEMPLATE",KT.options.current_template.name)}}});
/*
 * jQuery Form Plugin
 * version: 2.92 (22-NOV-2011)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Dual licensed under the MIT and GPL licenses:
 *	http://www.opensource.org/licenses/mit-license.php
 *	http://www.gnu.org/licenses/gpl.html
 */
(function(b){b.fn.ajaxSubmit=function(d){if(!this.length){a("ajaxSubmit: skipping submit process - no element selected");return this}var c,t,f,h=this;if(typeof d=="function"){d={success:d}}c=this.attr("method");t=this.attr("action");f=(typeof t==="string")?b.trim(t):"";f=f||window.location.href||"";if(f){f=(f.match(/^([^#]+)/)||[])[1]}d=b.extend(true,{url:f,success:b.ajaxSettings.success,type:c||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},d);var m={};this.trigger("form-pre-serialize",[this,d,m]);if(m.veto){a("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(d.beforeSerialize&&d.beforeSerialize(this,d)===false){a("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var g=d.traditional;if(g===undefined){g=b.ajaxSettings.traditional}var x,s,j,y=this.formToArray(d.semantic);if(d.data){d.extraData=d.data;x=b.param(d.data,g)}if(d.beforeSubmit&&d.beforeSubmit(y,this,d)===false){a("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[y,this,d,m]);if(m.veto){a("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var r=b.param(y,g);if(x){r=(r?(r+"&"+x):x)}if(d.type.toUpperCase()=="GET"){d.url+=(d.url.indexOf("?")>=0?"&":"?")+r;d.data=null}else{d.data=r}var A=[];if(d.resetForm){A.push(function(){h.resetForm()})}if(d.clearForm){A.push(function(){h.clearForm(d.includeHidden)})}if(!d.dataType&&d.target){var e=d.success||function(){};A.push(function(q){var n=d.replaceTarget?"replaceWith":"html";b(d.target)[n](q).each(e,arguments)})}else{if(d.success){A.push(d.success)}}d.success=function(C,q,D){var B=d.context||d;for(var v=0,n=A.length;v<n;v++){A[v].apply(B,[C,q,D||h,h])}};var w=b("input:file:enabled[value]",this);var i=w.length>0;var u="multipart/form-data";var p=(h.attr("enctype")==u||h.attr("encoding")==u);var o=!!(i&&w.get(0).files&&window.FormData);a("fileAPI :"+o);var k=(i||p)&&!o;if(d.iframe!==false&&(d.iframe||k)){if(d.closeKeepAlive){b.get(d.closeKeepAlive,function(){z(y)})}else{z(y)}}else{if((i||p)&&o){d.progress=d.progress||b.noop;l(y)}else{b.ajax(d)}}this.trigger("form-submit-notify",[this,d]);return this;function l(v){var n=new FormData();for(var B=0;B<v.length;B++){if(v[B].type=="file"){continue}n.append(v[B].name,v[B].value)}h.find("input:file:enabled").each(function(){var C=b(this).attr("name"),E=this.files;if(C){for(var D=0;D<E.length;D++){n.append(C,E[D])}}});d.data=null;var q=d.beforeSend;d.beforeSend=function(D,C){C.data=n;if(D.upload){D.upload.onprogress=function(E){C.progress(E.position,E.total)}}if(q){q.call(C,D,C)}};b.ajax(d)}function z(Z){var E=h[0],D,V,P,X,S,G,K,I,J,T,W,N;var H=!!b.fn.prop;if(Z){if(H){for(V=0;V<Z.length;V++){D=b(E[Z[V].name]);D.prop("disabled",false)}}else{for(V=0;V<Z.length;V++){D=b(E[Z[V].name]);D.removeAttr("disabled")}}}if(b(":input[name=submit],:input[id=submit]",E).length){alert('Error: Form elements must not have name or id of "submit".');return}P=b.extend(true,{},b.ajaxSettings,d);P.context=P.context||P;S="jqFormIO"+(new Date().getTime());if(P.iframeTarget){G=b(P.iframeTarget);T=G.attr("name");if(T==null){G.attr("name",S)}else{S=T}}else{G=b('<iframe name="'+S+'" src="'+P.iframeSrc+'" />');G.css({position:"absolute",top:"-1000px",left:"-1000px"})}K=G[0];I={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(n){var ac=(n==="timeout"?"timeout":"aborted");a("aborting upload... "+ac);this.aborted=1;G.attr("src",P.iframeSrc);I.error=ac;P.error&&P.error.call(P.context,I,ac,n);X&&b.event.trigger("ajaxError",[I,P,ac]);P.complete&&P.complete.call(P.context,I,ac)}};X=P.global;if(X&&!b.active++){b.event.trigger("ajaxStart")}if(X){b.event.trigger("ajaxSend",[I,P])}if(P.beforeSend&&P.beforeSend.call(P.context,I,P)===false){if(P.global){b.active--}return}if(I.aborted){return}J=E.clk;if(J){T=J.name;if(T&&!J.disabled){P.extraData=P.extraData||{};P.extraData[T]=J.value;if(J.type=="image"){P.extraData[T+".x"]=E.clk_x;P.extraData[T+".y"]=E.clk_y}}}var O=1;var L=2;function M(ac){var n=ac.contentWindow?ac.contentWindow.document:ac.contentDocument?ac.contentDocument:ac.document;return n}var C=b("meta[name=csrf-token]").attr("content");var B=b("meta[name=csrf-param]").attr("content");if(B&&C){P.extraData=P.extraData||{};P.extraData[B]=C}function U(){var ae=h.attr("target"),ac=h.attr("action");E.setAttribute("target",S);if(!c){E.setAttribute("method","POST")}if(ac!=P.url){E.setAttribute("action",P.url)}if(!P.skipEncodingOverride&&(!c||/post/i.test(c))){h.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(P.timeout){N=setTimeout(function(){W=true;R(O)},P.timeout)}function af(){try{var n=M(K).readyState;a("state = "+n);if(n.toLowerCase()=="uninitialized"){setTimeout(af,50)}}catch(ah){a("Server abort: ",ah," (",ah.name,")");R(L);N&&clearTimeout(N);N=undefined}}var ad=[];try{if(P.extraData){for(var ag in P.extraData){ad.push(b('<input type="hidden" name="'+ag+'">').attr("value",P.extraData[ag]).appendTo(E)[0])}}if(!P.iframeTarget){G.appendTo("body");K.attachEvent?K.attachEvent("onload",R):K.addEventListener("load",R,false)}setTimeout(af,15);E.submit()}finally{E.setAttribute("action",ac);if(ae){E.setAttribute("target",ae)}else{h.removeAttr("target")}b(ad).remove()}}if(P.forceSync){U()}else{setTimeout(U,10)}var aa,ab,Y=50,F;function R(ag){if(I.aborted||F){return}try{ab=M(K)}catch(aj){a("cannot access response document: ",aj);ag=L}if(ag===O&&I){I.abort("timeout");return}else{if(ag==L&&I){I.abort("server abort");return}}if(!ab||ab.location.href==P.iframeSrc){if(!W){return}}K.detachEvent?K.detachEvent("onload",R):K.removeEventListener("load",R,false);var ae="success",ai;try{if(W){throw"timeout"}var ad=P.dataType=="xml"||ab.XMLDocument||b.isXMLDoc(ab);a("isXml="+ad);if(!ad&&window.opera&&(ab.body==null||ab.body.innerHTML=="")){if(--Y){a("requeing onLoad callback, DOM not available");setTimeout(R,250);return}}var ak=ab.body?ab.body:ab.documentElement;I.responseText=ak?ak.innerHTML:null;I.responseXML=ab.XMLDocument?ab.XMLDocument:ab;if(ad){P.dataType="xml"}I.getResponseHeader=function(an){var am={"content-type":P.dataType};return am[an]};if(ak){I.status=Number(ak.getAttribute("status"))||I.status;I.statusText=ak.getAttribute("statusText")||I.statusText}var n=(P.dataType||"").toLowerCase();var ah=/(json|script|text)/.test(n);if(ah||P.textarea){var af=ab.getElementsByTagName("textarea")[0];if(af){I.responseText=af.value;I.status=Number(af.getAttribute("status"))||I.status;I.statusText=af.getAttribute("statusText")||I.statusText}else{if(ah){var ac=ab.getElementsByTagName("pre")[0];var al=ab.getElementsByTagName("body")[0];if(ac){I.responseText=ac.textContent?ac.textContent:ac.innerText}else{if(al){I.responseText=al.textContent?al.textContent:al.innerText}}}}}else{if(n=="xml"&&!I.responseXML&&I.responseText!=null){I.responseXML=Q(I.responseText)}}try{aa=q(I,n,P)}catch(ag){ae="parsererror";I.error=ai=(ag||ae)}}catch(ag){a("error caught: ",ag);ae="error";I.error=ai=(ag||ae)}if(I.aborted){a("upload aborted");ae=null}if(I.status){ae=(I.status>=200&&I.status<300||I.status===304)?"success":"error"}if(ae==="success"){P.success&&P.success.call(P.context,aa,"success",I);X&&b.event.trigger("ajaxSuccess",[I,P])}else{if(ae){if(ai==undefined){ai=I.statusText}P.error&&P.error.call(P.context,I,ae,ai);X&&b.event.trigger("ajaxError",[I,P,ai])}}X&&b.event.trigger("ajaxComplete",[I,P]);if(X&&!--b.active){b.event.trigger("ajaxStop")}P.complete&&P.complete.call(P.context,I,ae);F=true;if(P.timeout){clearTimeout(N)}setTimeout(function(){if(!P.iframeTarget){G.remove()}I.responseXML=null},100)}var Q=b.parseXML||function(n,ac){if(window.ActiveXObject){ac=new ActiveXObject("Microsoft.XMLDOM");ac.async="false";ac.loadXML(n)}else{ac=(new DOMParser()).parseFromString(n,"text/xml")}return(ac&&ac.documentElement&&ac.documentElement.nodeName!="parsererror")?ac:null};var v=b.parseJSON||function(n){return window["eval"]("("+n+")")};var q=function(ag,ae,ad){var ac=ag.getResponseHeader("content-type")||"",n=ae==="xml"||!ae&&ac.indexOf("xml")>=0,af=n?ag.responseXML:ag.responseText;if(n&&af.documentElement.nodeName==="parsererror"){b.error&&b.error("parsererror")}if(ad&&ad.dataFilter){af=ad.dataFilter(af,ae)}if(typeof af==="string"){if(ae==="json"||!ae&&ac.indexOf("json")>=0){af=v(af)}else{if(ae==="script"||!ae&&ac.indexOf("javascript")>=0){b.globalEval(af)}}}return af}}};b.fn.ajaxForm=function(c){if(this.length===0){var d={s:this.selector,c:this.context};if(!b.isReady&&d.s){a("DOM not ready, queuing ajaxForm");b(function(){b(d.s,d.c).ajaxForm(c)});return this}a("terminating; zero elements found by selector"+(b.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(f){if(!f.isDefaultPrevented()){f.preventDefault();b(this).ajaxSubmit(c)}}).bind("click.form-plugin",function(j){var i=j.target;var g=b(i);if(!(g.is(":submit,input:image"))){var f=g.closest(":submit");if(f.length==0){return}i=f[0]}var h=this;h.clk=i;if(i.type=="image"){if(j.offsetX!=undefined){h.clk_x=j.offsetX;h.clk_y=j.offsetY}else{if(typeof b.fn.offset=="function"){var k=g.offset();h.clk_x=j.pageX-k.left;h.clk_y=j.pageY-k.top}else{h.clk_x=j.pageX-i.offsetLeft;h.clk_y=j.pageY-i.offsetTop}}}setTimeout(function(){h.clk=h.clk_x=h.clk_y=null},100)})};b.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};b.fn.formToArray=function(q){var p=[];if(this.length===0){return p}var d=this[0];var g=q?d.getElementsByTagName("*"):d.elements;if(!g){return p}var k,h,f,r,e,m,c;for(k=0,m=g.length;k<m;k++){e=g[k];f=e.name;if(!f){continue}if(q&&d.clk&&e.type=="image"){if(!e.disabled&&d.clk==e){p.push({name:f,value:b(e).val(),type:e.type});p.push({name:f+".x",value:d.clk_x},{name:f+".y",value:d.clk_y})}continue}r=b.fieldValue(e,true);if(r&&r.constructor==Array){for(h=0,c=r.length;h<c;h++){p.push({name:f,value:r[h]})}}else{if(r!==null&&typeof r!="undefined"){p.push({name:f,value:r,type:e.type})}}}if(!q&&d.clk){var l=b(d.clk),o=l[0];f=o.name;if(f&&!o.disabled&&o.type=="image"){p.push({name:f,value:l.val()});p.push({name:f+".x",value:d.clk_x},{name:f+".y",value:d.clk_y})}}return p};b.fn.formSerialize=function(c){return b.param(this.formToArray(c))};b.fn.fieldSerialize=function(d){var c=[];this.each(function(){var h=this.name;if(!h){return}var f=b.fieldValue(this,d);if(f&&f.constructor==Array){for(var g=0,e=f.length;g<e;g++){c.push({name:h,value:f[g]})}}else{if(f!==null&&typeof f!="undefined"){c.push({name:this.name,value:f})}}});return b.param(c)};b.fn.fieldValue=function(h){for(var g=[],e=0,c=this.length;e<c;e++){var f=this[e];var d=b.fieldValue(f,h);if(d===null||typeof d=="undefined"||(d.constructor==Array&&!d.length)){continue}d.constructor==Array?b.merge(g,d):g.push(d)}return g};b.fieldValue=function(c,j){var e=c.name,p=c.type,q=c.tagName.toLowerCase();if(j===undefined){j=true}if(j&&(!e||c.disabled||p=="reset"||p=="button"||(p=="checkbox"||p=="radio")&&!c.checked||(p=="submit"||p=="image")&&c.form&&c.form.clk!=c||q=="select"&&c.selectedIndex==-1)){return null}if(q=="select"){var k=c.selectedIndex;if(k<0){return null}var m=[],d=c.options;var g=(p=="select-one");var l=(g?k+1:d.length);for(var f=(g?k:0);f<l;f++){var h=d[f];if(h.selected){var o=h.value;if(!o){o=(h.attributes&&h.attributes.value&&!(h.attributes.value.specified))?h.text:h.value}if(g){return o}m.push(o)}}return m}return b(c).val()};b.fn.clearForm=function(c){return this.each(function(){b("input,select,textarea",this).clearFields(c)})};b.fn.clearFields=b.fn.clearInputs=function(c){var d=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var f=this.type,e=this.tagName.toLowerCase();if(d.test(f)||e=="textarea"||(c&&/hidden/.test(f))){this.value=""}else{if(f=="checkbox"||f=="radio"){this.checked=false}else{if(e=="select"){this.selectedIndex=-1}}}})};b.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType)){this.reset()}})};b.fn.enable=function(c){if(c===undefined){c=true}return this.each(function(){this.disabled=!c})};b.fn.selected=function(c){if(c===undefined){c=true}return this.each(function(){var d=this.type;if(d=="checkbox"||d=="radio"){this.checked=c}else{if(this.tagName.toLowerCase()=="option"){var e=b(this).parent("select");if(c&&e[0]&&e[0].type=="select-one"){e.find("option").selected(false)}this.selected=c}}})};b.fn.ajaxSubmit.debug=false;function a(){if(!b.fn.ajaxSubmit.debug){return}var c="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(c)}else{if(window.opera&&window.opera.postError){window.opera.postError(c)}}}})(jQuery);jQuery.fn.sortElements=(function(){var a=[].sort;return function(c,d){d=d||function(){return this};var b=this.map(function(){var f=d.call(this),e=f.parentNode,g=e.insertBefore(document.createTextNode(""),f.nextSibling);return function(){if(e===this){throw new Error("You can't sort elements if any one is a descendant of another.")}e.insertBefore(this,g);e.removeChild(g)}});return a.call(this,c).each(function(e){b[e].call(d.call(this))})}})();