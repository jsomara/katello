KT.panel.list.registerPage("gpg_keys",{create:"new_gpg_key"});$(document).ready(function(){$("#upload_gpg_key").live("click",function(a){KT.gpg_key.upload()});$("#update_upload_gpg_key").live("click",function(a){KT.gpg_key.upload_update()});$("#gpg_key_content").live("input keyup paste",function(){if($(this).val()!==""){$("#gpg_key_content_upload").attr("disabled","disabled");$("#upload_gpg_key").attr("disabled","disabled");$("#clear_gpg_key").removeAttr("disabled")}else{$("#gpg_key_content_upload").removeAttr("disabled");$("#upload_gpg_key").removeAttr("disabled");$("#clear_gpg_key").attr("disabled","disabled")}});$("#gpg_key_content_upload").live("change",function(){if($(this).val()!==""){$("#gpg_key_content").attr("disabled","disabled");$("#save_gpg_key").attr("disabled","disabled");$("#clear_upload_gpg_key").removeAttr("disabled")}else{$("#gpg_key_content").removeAttr("disabled");$("#save_gpg_key").removeAttr("disabled");$("#clear_upload_gpg_key").attr("disabled","disabled")}});$("#clear_upload_gpg_key").live("click",function(){$("#gpg_key_content_upload").val("");$("#gpg_key_content").removeAttr("disabled");$("#save_gpg_key").removeAttr("disabled");$("#clear_upload_gpg_key").attr("disabled","disabled");$("#clear_gpg_key").attr("disabled","disabled")});$("#clear_gpg_key").live("click",function(){$("#gpg_key_content").val("");$("#gpg_key_content_upload").removeAttr("disabled");$("#upload_gpg_key").removeAttr("disabled");$("#clear_upload_gpg_key").attr("disabled","disabled");$("#clear_gpg_key").attr("disabled","disabled")});$("#gpg_key_content_upload_update").live("change",function(){if($(this).val()!==""){$("#update_upload_gpg_key").removeAttr("disabled");$("#clear_upload_gpg_key").removeAttr("disabled")}else{$("#update_upload_gpg_key").attr("disabled","disabled");$("#clear_upload_gpg_key").attr("disabled","disabled")}});$("#clear_upload_gpg_key").live("click",function(){$("#update_upload_gpg_key").attr("disabled","disabled");$("#clear_upload_gpg_key").attr("disabled","disabled");$("#gpg_key_content_upload_update").val("")})});KT.gpg_key=(function(c){var b=this,d=function(){return{gpg_key_save:c("#save_gpg_key"),gpg_key_upload:c("#upload_gpg_key")}},e=function(){var f=d();f.gpg_key_save.removeAttr("disabled");f.gpg_key_upload.removeAttr("disabled")},a=function(){var f=d();f.gpg_key_save.attr("disabled","disabled");f.gpg_key_upload.attr("disabled","disabled")};b.upload=function(){var f={"gpg_key[name]":c("#gpg_key_name").val()};a();c("#upload_new_gpg_key").ajaxSubmit({url:KT.routes.gpg_keys_path(),type:"POST",data:f,iframe:true,success:function(i,g,j){var h=c(i);if(h.get(0).tagName==="PRE"){notices.displayNotice("error",h.html())}else{KT.panel.list.createSuccess(i)}e()},error:function(){e();notices.checkNotices()}})};b.upload_update=function(){c("#update_upload_gpg_key").attr("disabled","disabled");c("#clear_upload_gpg_key").attr("disabled","disabled");c("#upload_gpg_key").ajaxSubmit({url:c(this).data("url"),type:"POST",iframe:true,success:function(g,f,h){c("#gpg_key_content").html(g);notices.checkNoticesInResponse(h);c("#upload_gpg_key").val("")},error:function(){c("#update_upload_gpg_key").removeAttr("disabled");c("#clear_upload_gpg_key").removeAttr("disabled");notices.checkNotices()}})};return b})(jQuery);