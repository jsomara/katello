$(document).ready(function(){$("#products_more").bind("click",function(){KT.products.moreProducts()});$("#products_sort").bind("click",function(){KT.products.reverseSort()})});KT.products=(function(){return{moreProducts:function(){var c=$(".products");var b=$("#products_more");var e=$("#list-spinner");var a=b.attr("data-scroll_url");var d=parseInt(b.attr("data-offset"),10)+parseInt(b.attr("data-page_size"),10);a=a+"?offset="+d+"&order="+$("#products_sort").attr("data-sort")+"&";e.fadeIn();$.ajax({type:"GET",url:a,cache:false,success:function(f){KT.products.retrievingNewContent=false;e.fadeOut();c.append(f);$("#filter").keyup();$(".scroll-pane").jScrollPane().data("jsp").reinitialise();if(f.length==0){b.hide()}b.attr("data-offset",d)},error:function(){e.fadeOut();KT.products.retrievingNewContent=false}})},sortOrder:function(){var b=$("#products_sort");var a=b.attr("data-sort");if(b.attr("data-sort")=="asc"){a="desc";b.removeClass("ascending").addClass("descending")}else{a="asc";b.removeClass("descending").addClass("ascending")}b.attr("data-sort",a);return a},reverseSort:function(){var d=$(".products");var c=$("#products_more");var e=$("#list-spinner");var a=c.attr("data-scroll_url");var b=parseInt(c.attr("data-offset"),10);a=a+"?reverse="+b+"&order="+KT.products.sortOrder()+"&";e.fadeIn();d.find("tbody > tr").empty().remove();$.ajax({type:"GET",url:a,cache:false,success:function(f){KT.products.retrievingNewContent=false;e.fadeOut();d.append(f);$("#filter").keyup();$(".scroll-pane").jScrollPane().data("jsp").reinitialise();if(f.length==0){c.empty().remove()}else{$("#products_more").attr("data-offset",b)}},error:function(){e.fadeOut();KT.products.retrievingNewContent=false}})},retrievingNewContent:true}})();